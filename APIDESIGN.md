# Uno API Design

| Action                  | Inputs/Data                 | Pre-conditions                                                                 | Post-conditions                                                                                                                                    | API Endpoint                                                                                                         |
| ----------------------- | --------------------------- | ------------------------------------------------------------------------------ | -------------------------------------------------------------------------------------------------------------------------------------------------- | -------------------------------------------------------------------------------------------------------------------- |
| Create a lobby          |                             |                                                                                | A new lobby is created with lobby id                                                                                                               | POST games/:lobby_id/create                                                                                          |
| Join a lobby            | lobby_id, player_id         | The lobby exists and has available player slots                                | The player is added to the lobby and their id is shown in the lobby's list of players                                                              | POST /games/lobbies/:lobby_id/join <br><br>(lobby_id is provided in url, player_id is available in the session)      |
| Leave a lobby           | lobby_id, player_id         | The lobby exists and the player is in the lobby                                | The player is removed from the lobby and their id is no longer shown in the lobby's list of players                                                | DELETE /games/lobbies/:lobby_id/players <br><br>(lobby_id is provided in url, player_id is available in the session) |
| Get all lobbies         |                             |                                                                                | Returns all lobbies with lobby id and current number of players                                                                                    | GET /games/lobbies                                                                                                   |
| Start a game in a lobby | lobby_id                    | The lobby exists and has at least two players                                  | A new game is started in the lobby, with a deck of shuffled cards, a starting hand is dealt to each player, and a chat box is created for the game | POST /games/lobbies/:lobby_id/game                                                                                   |
| Play a card             | game_id, player_id, card_id | The game and player exist, and it's the player's turn to play                  | The card is added to the top of the discard pile and removed from the player's hand, and the game state is updated                                 | PUT /games/:game_id/play <br><br>(game_id is provided in url, player_id and card_id is available in the session)     |
| Draw a card             | game_id, player_id          | The game and player exist, and it's the player's turn to draw                  | A card is drawn from the top of the deck and added to the player's hand, and the game state is updated                                             | PUT /games/:game_id/draw <br><br>(game_id is provided in url, player_id is available in the session)                 |
| Call Uno                | game_id, player_id          | The game and player exist, and the player has only one card left in their hand | The player is marked as having called Uno. If they fail to call then they must draw two cards                                                      | PUT /games/:game_id/uno <br><br>(game_id is provided in url, player_id is available in the session)                  |
| Send a chat message     | game_id, player_id, message | The game and player exist                                                      | The message is added to the chat box for the game                                                                                                  | POST /games/:game_id/chat <br><br>(game_id is provided in url, player_id and message is available in the session)    |
| Save player state       | game_id, player_id          | The game and player exist                                                      | The player's current state is saved in the database, so that they can leave the game and rejoin later without losing their progress                | PUT /games/:game_id/state <br><br>(game_id is provided in url, player_id is available in the session)                |
| Get game state          | game_id                     | A game with the game_id exists                                                 | Returns the current state of the game which contains the current player, their hand, the top card of the discard pile, and the chat messages       | GET /games/:game_id/state                                                                                            |
